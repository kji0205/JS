<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>

<body>
    <style type="text/css">
    body {
        width: 300px;
        /*height: 300px;*/
    }
    
    .wrapper {
        border: 2px dotted gray;
    }
    
    table {
        border: 2px solid black;
    }
    
    tr {
        /*border: 1px solid green;*/
    }
    
    td {
        border: 1px solid gray;
        background-color: #9e9e9e;
        width: 15px;
        /*height: 10px;*/
    }
    
    .td2 {
        border: 1px solid gray;
        background-color: #e6e6e6;
        width: 15px;
        /*height: 10px;*/
    }
    
    .td3 {
        border: 1px solid gray;
        background-color: red;
        width: 15px;
        /*height: 10px;*/
    }
    </style>
    <div class="row">
        <!-- <div>
		<select>
			<option value="5">5</option>
			<option value="10">10</option>
			<option value="15">15</option>
			<option value="20">20</option>
		</select>
		<input type="button" name="" value="Change">
	</div> -->
        <div class="col-xs-12 col-md-8">
            <label class="lbl"></label>
        </div>
        <div class="col-xs-12 col-md-8 tblArea">
            <table class="table table-bordered">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
        </div>
    </div>
    <script type="text/javascript">
    // landMine
    const horizontalSize = 10;
    const verticalSize = horizontalSize;
    const hvSize = horizontalSize * verticalSize;
    console.log('horizontalSize :: ' + horizontalSize);
    console.log('verticalSize :: ' + verticalSize);
    console.log('hvSize :: ' + hvSize);

    var table = document.createElement('table');

    var fnInit = (function(p) {
        return function() {
            console.log(p);
            if (td[p].innerText === 'X') {
                alert('Fail');
                td[p].className = 'td3';
            } else {
                fnAction(p);
                td[p].className = 'td2';
            }
        }
    });

    for (var i = verticalSize - 1; i >= 0; i--) {
        var tr = document.createElement('tr');
        for (var j = horizontalSize - 1; j >= 0; j--) {
            var td = document.createElement('td');
            // td.style.border = "1px solid #92acbb"; 
            // td.addEventListener('click', fnInit(i*j), false);
            tr.appendChild(td);
        }
        table.appendChild(tr);
    }
    // document.body.appendChild(table);
    document.querySelector('.tblArea').innerHTML = '';
    document.querySelector('.tblArea').appendChild(table);

    var td = document.getElementsByTagName('td');
    console.log('td.length :: ' + td.length);

    const k = 5; // max mine count
    var kn = 0; // mine count current

    for (var i = td.length - 1; i >= 0; i--) {
        if (false) {} else {
            td[i].innerHTML = '&nbsp;';
        }
        td[i].addEventListener('click', fnInit(i), false);
    }
    
    for (var i = 5 - 1; i >= 0; i--) {
        var n = Math.floor(Math.random() * hvSize) + 1;
        console.log(n);
        td[n - 1].innerText = 'X';
    }

    var fnAction = (function(seq) {
        var arr = [];
        var a = td[seq - 1] ? td[seq - 1].innerText : '';
        var b = td[seq + 1] ? td[seq + 1].innerText : '';
        var c = td[seq - horizontalSize] ? td[seq - horizontalSize].innerText : '';
        var c1 = td[seq - horizontalSize - 1] ? td[seq - horizontalSize - 1].innkrText : '';
        var c2 = td[seq - horizontalSize + 1] ? td[seq - horizontalSize + 1].innerText : '';
        var d = td[seq + horizontalSize] ? td[seq + horizontalSize].innerText : '';
        var d1 = td[seq + horizontalSize - 1] ? td[seq + horizontalSize - 1].innerText : '';
        var d2 = td[seq + horizontalSize + 1] ? td[seq + horizontalSize + 1].innerText : '';

        if (a === 'X' || b === 'X' || c === 'X' || d === 'X' || c1 === 'X' || c2 === 'X' || d1 === 'X' || d2 === 'X') {
            alert('Fail');
            for (var i = arr.length - 1; i >= 0; i--) {
                // if (arr[i]) console.log(i);
            }
            if (td[seq - 1] && td[seq - 1].innerText === 'X') td[seq - 1].className = 'td3';
            if (td[seq + 1] && td[seq + 1].innerText === 'X') td[seq + 1].className = 'td3';
            if (td[seq - horizontalSize] && td[seq - horizontalSize].innerText === 'X') td[seq - horizontalSize].className = 'td3';
            if (td[seq - horizontalSize - 1] && td[seq - horizontalSize - 1].innerText === 'X') td[seq - horizontalSize - 1].className = 'td3';
            if (td[seq - horizontalSize + 1] && td[seq - horizontalSize + 1].innerText === 'X') td[seq - horizontalSize + 1].className = 'td3';
            if (td[seq + horizontalSize] && td[seq + horizontalSize].innerText === 'X') td[seq + horizontalSize].className = 'td3';
            if (td[seq + horizontalSize - 1] && td[seq + horizontalSize - 1].innerText === 'X') td[seq + horizontalSize - 1].className = 'td3';
            if (td[seq + horizontalSize + 1] && td[seq + horizontalSize + 1].innerText === 'X') td[seq + horizontalSize + 1].className = 'td3';
        } else {
            if (td[seq - 1]) td[seq - 1].className = 'td2';
            if (td[seq + 1]) td[seq + 1].className = 'td2';
            if (td[seq - horizontalSize]) td[seq - horizontalSize].className = 'td2';
            if (td[seq - horizontalSize - 1]) td[seq - horizontalSize - 1].className = 'td2';
            if (td[seq - horizontalSize + 1]) td[seq - horizontalSize + 1].className = 'td2';
            if (td[seq + horizontalSize]) td[seq + horizontalSize].className = 'td2';
            if (td[seq + horizontalSize - 1]) td[seq + horizontalSize - 1].className = 'td2';
            if (td[seq + horizontalSize + 1]) td[seq + horizontalSize + 1].className = 'td2';
        }
    });


    var SetTime = 50; // 최초 설정 시간(기본 : 초)

    function msg_time() { // 1초씩 카운트

        m = Math.floor(SetTime / 60) + '분 ' + (SetTime % 60) + '초'; // 남은 시간 계산
        document.querySelector('.lbl').innerText = m;
        SetTime--; // 1초씩 감소
        if (SetTime < 0) { // 시간이 종료 되었으면..
            clearInterval(tid); // 타이머 해제
            // alert("종료");
        }
    }

    window.onload = function TimerStart() {
        tid = setInterval('msg_time()', 1000)
    };
    </script>
</body>

</html>
