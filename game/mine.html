<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>

<style type="text/css">

	body{
		width: 300px;
		height: 300px;
	}
	.wrapper {
		border: 2px dotted gray;
	}
	table{
		border: 1px solid black;
	}
	tr{
		border: 1px solid green;
	}
	td {
		border: 1px solid gray;
		background-color: #9e9e9e;
		width: 10px;
		height: 10px;
	}
	.td2{
		border: 1px solid gray;
		background-color: #e6e6e6;
		width: 10px;
		height: 10px;
	}
	.td3{
		border: 1px solid gray;
		background-color: red;
		width: 10px;
		height: 10px;
	}
</style>
<div class="row">
	<!-- <div>
		<select>
			<option value="5">5</option>
			<option value="10">10</option>
			<option value="15">15</option>
			<option value="20">20</option>
		</select>
		<input type="button" name="" value="Change">
	</div> -->
	<div class="col-xs-12 col-md-8">
		<label class="lbl"></label>
	</div>
	<div class="col-xs-12 col-md-8">
		<table class="table table-bordered">
			<tr>
				<td></td><td></td><td></td><td></td><td></td>
			</tr>
			<tr>
				<td></td><td></td><td></td><td></td><td></td>
			</tr>
			<tr>
				<td></td><td></td><td></td><td></td><td></td>
			</tr>
			<tr>
				<td></td><td></td><td></td><td></td><td></td>
			</tr>
			<tr>
				<td></td><td></td><td></td><td></td><td></td>
			</tr>
		</table>
	</div>
</div>
<script type="text/javascript">

	var td = document.getElementsByTagName('td');
	console.log(td.length);
	
	var k = 5; // 최대 지뢰 갯수
	var kn = 0; // 현재 지뢰가 생성된 갯수

	var fnInit = function(p){
		return function(){
			console.log(p);	
			if (td[p].innerText === 'X') {
				alert('Fail');
				td[p].className = 'td3';
			}else{
				fnAction(p);
				td[p].className = "td2";
			}
		}
	}

	var fnAction = function(p){
		var arr = [];
		var a = td[p-1] ? td[p-1].innerText : '';
		var b = td[p+1] ? td[p+1].innerText : '';
		var c = td[p-5] ? td[p-5].innerText : '';
		var c1 = td[p-5-1] ? td[p-5-1].innerText : '';
		var c2 = td[p-5+1] ? td[p-5+1].innerText : '';
		var d = td[p+5] ? td[p+5].innerText : '';
		var d1 = td[p+5-1] ? td[p+5-1].innerText : '';
		var d2 = td[p+5+1] ? td[p+5+1].innerText : '';
		arr.push(a);
		arr.push(b);
		arr.push(c);
		arr.push(c1);
		arr.push(c2);
		arr.push(d);
		arr.push(d1);
		arr.push(d2);

		if (a === 'X' || b === 'X' || c === 'X' || d === 'X' || c1 === 'X' || c2 === 'X' || d1 === 'X' || d2 === 'X') {
			alert('Fail');
			for (var i = arr.length - 1; i >= 0; i--) {
				// if (arr[i]) console.log(i);
			}
			if (td[p-1] && td[p-1].innerText === 'X') td[p-1].className = "td3";
			if (td[p+1] && td[p+1].innerText === 'X') td[p+1].className = "td3";
			if (td[p-5] && td[p-5].innerText === 'X') td[p-5].className = "td3";
			if (td[p-5-1] && td[p-5-1].innerText === 'X') td[p-5-1].className = "td3";
			if (td[p-5+1] && td[p-5+1].innerText === 'X') td[p-5+1].className = "td3";
			if (td[p+5] && td[p+5].innerText === 'X') td[p+5].className = "td3";
			if (td[p+5-1] && td[p+5-1].innerText === 'X') td[p+5-1].className = "td3";
			if (td[p+5+1] && td[p+5+1].innerText === 'X') td[p+5+1].className = "td3";
		} else {
			if (td[p-1]) td[p-1].className = "td2";
			if (td[p+1]) td[p+1].className = "td2";
			if (td[p-5]) td[p-5].className = "td2";
			if (td[p-5-1]) td[p-5-1].className = "td2";
			if (td[p-5+1]) td[p-5+1].className = "td2";
			if (td[p+5]) td[p+5].className = "td2";
			if (td[p+5-1]) td[p+5-1].className = "td2";
			if (td[p+5+1]) td[p+5+1].className = "td2";
		}
	}

	for (var i = td.length - 1; i >= 0; i--) {
		if (false) {
		} else {
			td[i].innerHTML = '&nbsp;';
		}
		td[i].addEventListener('click', fnInit(i), false);
	}

	for (var i = 5 - 1; i >= 0; i--) {
		var n = Math.floor(Math.random()*25)+1;
		console.log(n);
		td[n-1].innerText = 'X';
	}

	var SetTime = 50;		// 최초 설정 시간(기본 : 초)

	function msg_time() {	// 1초씩 카운트
		
		m = Math.floor(SetTime / 60) + "분 " + (SetTime % 60) + "초";	// 남은 시간 계산
		document.querySelector('.lbl').innerText = m;
		SetTime--;					// 1초씩 감소
		if (SetTime < 0) {			// 시간이 종료 되었으면..
			clearInterval(tid);		// 타이머 해제
			// alert("종료");
		}
	}

	window.onload = function TimerStart(){ tid=setInterval('msg_time()',1000) };


</script>

</body>
</html>